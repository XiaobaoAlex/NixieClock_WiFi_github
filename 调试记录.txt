先看资料

原理图已绘制完成

元器件已购买

pcb已初步布局

接下来进行精细布局，确定辉光管、氖管封装大小及位置，底板大小并建立三维模型，用solidworks绘制亚克力板模型

60x215较小，四周没有放置图案花纹的地方。打算扩大至75x230

电路板已发去打板

软件已编好

开始绘制3维模型

3维模型已画好

面板发去加工

升压电路焊接完毕，无法正常工作，查看数据手册发现mtd20N03hdl

mosDS之间的耐压值不够大，当初选这个是因为数据手册上的典型应用是这个，但是它那个是12V,5V低压输出，可以用这个低压mos管

试图更换MOS管IRFR420BTM

注重在制作过程中的拍照记录

贴片发光二极管有颜色的那一头为正

调试记录：

1、单片机是可以正常运行的，可使状态指示灯按照程序点亮熄灭

2、继电器应该是好使的，但闭合和断开时对应的升压电路的值为0和4.4V,考虑是继电器能通过的最大电流的值不够。

3、不应该是继电器能通过的最大电流的值不够这个原因。

4、辉光管驱动芯片VPP引脚处的稳压二极管稳压范围不够，已冒烟烧毁，可能是这个原因导致升压电路不能输出正常电压，寻找大电压范围的稳压管

5、经查数据手册和检查电路，发现稳压二极管焊反，而且稳压二极管的稳压值是对的，HV57708的VPP就是在90V之下。

6、稳压二极管调整之后稳压在70V,但是其他地方的170V也被稳在 了70V.

7、软件中，和esp8266进行串口通信存在问题，无法接收数据

8、单片机串口电平为5v,ESP8266串口电平为3.3V，二者不能直接相连。在网上看了许多解决办法，有的说兼容，有的说串联200欧电阻，有的说有三极管做个简单的转换电路，有的说用电平转换芯片，决定上电平转换芯片重新制版

9、esp8266的灯不是很亮

10、去点稳压管和限流电阻之后电压回到了170V,但是纹波很大

11、氖管的大圆筒接负极

12、画完板之后用串口调试助手试试wifi模块

~~13、升压电路准备俩个电容位焊接电容~~

14、留出方形焊盘电源输入接口供可调电源输入以显示消耗电流

15、升压电路注意布局

16、去掉拨码开关改加按键在左侧

17、更改RS1G封装、继电器封装、

18、3.3V降压芯片放在右边离芯片近处，给时钟和wifi芯片更好的供电

19、由于240k限流电阻的焊盘太小了，导致虚焊或者错位，又或者印制电路板的原因，电阻焊上之后阻值莫名的小，只有53欧，然后就导致升压电路提供电流能力不足，只能被拉到70V,至此问题已清晰明朗。

20、把升压电路输出电容换大电压会稳很多

21、把所有小规格焊盘全部替换掉。

22、下次生成gerber文件记得过孔盖油

23、焊完电源焊最小系统板，不然真的不知道最小系统板为什么不能正常运行

24、板子焊完后发现单片机不能下载进程序，硬件电路重焊过后还是不好使，目前不能找出原因

25、已重新焊了最小系统，测试了可以正常运行，打算在这个板子上继续焊接

26、稳压二极管俩端电压还是有问题，稳在了10V以内的电压，但是升压电路输出的电压正常，限流电阻测出的阻值极大，这可能是稳压不正常的原因

27、串口通信注意TX,RX不要接错

28、波特率不一致但接近可能也会出现通信不成功的情况，减小波特率并缩小两者波特率之差可能会成功

29、esp8266模块出现发送指令之后，先返回发送的指令字符然后在返回应答字符，已购买逻辑分析仪等待进行下一步试验。示波器虽然也能实现逻辑分析仪的功能但还是比较费劲

30、逻辑分析仪非常好用，已解决wifi模块问题，上述现象是wifi模块的回显模式造成的，关闭即可

31、hv57708驱动已编写完成并验证测试成功。编写驱动需充分理解数据手册，不然不能理解别人程序是意思，虽然能借鉴但肯定不能完全适配自己项目的情况

32、这些管子由于生产年限久远加上当年生产技术的关系，完美程度不高，常见的一个通病就是显示笔段不完全，尤其是在标准供电电压下，很多的南昌牌与宇宙牌的管子显示亮度很差，很多笔画多处显示不全，这个问题在最初开发的时候搞的非常头痛。后来经过实际测试，找到的解决方法也比较简单，那就是提高驱动电压与降低限流电阻。通过实际的测试发现，只要不是老化非常严重的管子，一般驱动电压提高到200～250V左右，限流电阻阻值降低２０％～３０％左右时，大部分的管子都可以确保正常的显示亮度。极个别的管子如果依旧有个别的字符显示不全，则可尝试进行活化修复处理。

33、换成2.2M欧电阻过后电压变成了122-125V之间

34、换成1.8M欧电阻过后电压加6个管子变成了122-125V之间

35、换成1.8M欧电阻过后电压加2个管子变成了147-148V之间

36、换成1.8M欧电阻过后电压加1个管子变成了160-164V之间

37、稳压管的电压容易在运行一段时间后变为4V

38、空载电流在80mA-140mA

39、加上一个管子电流在150到200mA

40、把电感值加大，换成330uH后加两个管子变成130V左右,还是不行（听师兄说带载能力不够应该换小感值）

41、准备重新制版，电源换成12V，5v稳压换7805，去掉继电器，去掉hv57708上拉电阻,去掉WiFi模块电阻和二极管，去掉usb,添加12v接口，过孔盖油

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5fb34bc5-e241-48d2-96e2-b53624f37c90/Untitled.png)

42、板子已改好发去嘉立创加工

43、板子已到准备焊接

44、新板电源纹波在159mV和239mV之间跳动，晶振不起振。

45、老板电源纹波和新版差不多，但是晶振起振，在晶振下方测量会出现良好正弦波形，频率为4Mhz

46、晶振两边的电压2.4V（正弦输出端）和1.1V，焊了最小系统，也不行。

47、换了2.2M欧的RF,晶振两边的电压3.0V（正弦输出端）和1.6V

48、第四版已发去加工，改进了晶振PCB布局

49、第四版最小系统已焊接，晶振俩端的电压为0.1v左右，正常的晶振俩端电压为2.2-2.3V.准备换一批元器件试试

50、已从电子大世界重新采购一批元器件，准备焊接测试

51、今天下午再焊一版试试，不行重新修改

52、下午焊的新版成功运行程序，在7805的输出端加了10uf的电容

53、弄清楚c语言双引号和单引号的区别，双引号会自动在字符串的末尾加上'\0'，单引号不会，而c语言函数库正是使用这个来判断该字符串是否结束，否则程序可能跑异常。

54、时钟初始化时向小时寄存器写0，导致时钟芯片在不连接互联网正时时小时位寄存器为0.